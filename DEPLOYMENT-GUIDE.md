# Deployment Guide for Amazing-Frog Water Station Dashboard

This guide explains how to deploy the Angular application to GitHub Pages with a custom domain (www.puddledude.com).

---

## Prerequisites

- Git installed and configured
- GitHub repository created
- Node.js and npm installed
- Namecheap account with domain purchased

---

## Part A: Copying to a Fresh Angular 20 Application

If you want to recreate this application in a fresh Angular 20 project, follow these steps.

### A.1 Create Fresh Angular App

```bash
ng new my-water-dashboard --routing --style=scss
cd my-water-dashboard
```

### A.2 Install Dependencies

```bash
npm install @angular/material @angular/cdk chart.js chartjs-adapter-date-fns date-fns
```

### A.3 Add Angular Material

```bash
ng add @angular/material
```

When prompted:
- Choose a theme: **Indigo/Pink** (or any prebuilt theme)
- Set up typography: **Yes**
- Include animations: **Yes**

### A.4 Essential Files to Copy

Copy these files from the working application to your fresh project:

#### Configuration Files (Root Level)

- `angular.json`
- `package.json`
- `src/favicon.ico`
- `src/index.html`
- `src/main.ts`
- `src/polyfills.ts`
- `src/styles.scss`

#### Environment Files

- `src/environments/environment.ts`
- `src/environments/environment.prod.ts`

#### App Module and Routing

- `src/app/app.module.ts`
- `src/app/app-routing.module.ts`

#### Shared Module (if any)

- `src/app/shared/shared.module.ts`

#### Components

Copy individual components from `src/app` as needed.

#### Assets

- `src/assets/` (entire folder)

#### Styles

- `src/styles.scss` (or your global styles file)

---

## Step 1: Prepare the Application

### 1.1 Install Dependencies

```bash
npm install
```

### 1.2 Create Required Files

Ensure these files exist in the `public/` folder:

**File: `public/CNAME`**

```
www.puddledude.com
```

**File: `public/_redirects`**

```
/*    https://www.puddledude.com/:splat   301!
```

### 1.3 Update `angular.json`

Set the `outputPath` for the `build` target to `public`:

```json
"projects": {
  "your-project-name": {
    "architect": {
      "build": {
        "options": {
          "outputPath": "public",
        }
      }
    }
  }
}
```

### 1.4 Build the Application

```bash
ng build --prod
```

---

## Step 2: Deploy to GitHub Pages

### 2.1 Initialize GitHub Pages

If not already done, initialize the `gh-pages` branch:

```bash
git checkout --orphan gh-pages
git rm -rf .
```

### 2.2 Copy Files to Root

Copy all files from the `public/` folder to the root of the repository.

### 2.3 Commit and Push

```bash
git add .
git commit -m "Deploy Angular app to GitHub Pages"
git push origin gh-pages --force
```

---

## Step 3: Configure Custom Domain

### 3.1 GitHub Repository Settings

- Go to your repository on GitHub.
- Click on "Settings".
- Scroll down to the "GitHub Pages" section.
- Set the custom domain to `www.puddledude.com`.

### 3.2 Namecheap Domain Settings

- Log in to your Namecheap account.
- Go to "Domain List" and find your domain.
- Click on "Manage" next to your domain.
- Set the following DNS records:
  - **CNAME Record**: `www` points to `your-github-username.github.io`.
  - **URL Redirect Record**: `@` redirects to `www.puddledude.com`.

---

## Step 4: Verify Deployment

- Visit `www.puddledude.com` to see your deployed Angular application.
- Check the browser console for any errors and fix them as needed.

---

## Troubleshooting Common Issues

- **404 Error on GitHub Pages**: Ensure the `CNAME` file is correctly set up and the custom domain is configured in the repository settings.
- **Build Errors**: Double-check the `angular.json` configuration and ensure all dependencies are correctly installed.
- **DNS Propagation Issues**: It may take some time for DNS changes to propagate. Wait for a few minutes and try again.

---

## Additional Resources

- [Angular Deployment Documentation](https://angular.io/guide/deployment)
- [GitHub Pages Documentation](https://docs.github.com/en/pages)
- [Namecheap Domain Management](https://www.namecheap.com/support/knowledgebase/category.aspx/10/domain-management/)

---

Congratulations! You have successfully deployed the Amazing-Frog Water Station Dashboard to GitHub Pages with a custom domain.

Dan-grummon: This prompt was generated by chatgpt and may not describe the best plan or practices for building this project. Please fix this prompt where needed to make the best website functionally and visually. This application will have 3 dropdown menus, one that uses a list of states, data obtained by querying a usgs api endpoint. When a state from the dropdown list is selected then a second api query will retrieve a list of counties and populate a counties dropdown menu. When a county is selected it will trigger a third api query that will retrieve a list of monitoring sites. When a monitoring site is selected it will trigger a 4th and 5th query to recieve graphing points for a graph of Gage Height and a graph of Streamflow for that location. The graphs will be daily along the horizontal axis. The graphs should show the last 3 months of of data. 

The webpage that describes the endpoints is:

https://api.waterdata.usgs.gov/ogcapi/v0/openapi#/

The constructed endpoint urls in the prompt are correct and tested for rendering graphs for the sugar creek location in Indiana.

GitHub Copilot: I'll review and improve this prompt to create a better specification for building a high-quality Angular application. Here are the key improvements needed:

### [amazing-frog-full-master-prompt.md](file:///c%3A/Users/dgrummon/git/amazing-frog/amazing-frog-full-master-prompt.md)

Improved the prompt with better practices, clearer specifications, corrected API field names, proper error handling, and enhanced UX requirements.

````markdown
# Amazing-Frog Water Station Angular Dashboard ‚Äî Full Master Prompt

You are an expert Angular architect and TypeScript developer. Generate the **complete Angular application** described below.  
Your output must include all required code files, full implementations, and best practices.

This prompt defines the complete specification for the **Amazing-Frog Water Station Dashboard**, an Angular web application that consumes USGS Water Data OGC APIs and is deployed on GitHub Pages.

---

# 1. PROJECT OVERVIEW

Build a production-ready Angular application called **Amazing-Frog Water Station Dashboard**.

The app will:

- Provide a cascading selection interface:
  1. **State** dropdown (populated on page load)
  2. **County** dropdown (populated after state selection)
  3. **Monitoring Location** dropdown (populated after county selection)
- Retrieve and display:
  - Station metadata card
  - **Gage Height** chart (last 90 days, parameter code 00065)
  - **Streamflow/Discharge** chart (last 90 days, parameter code 00060)
- Handle edge cases:
  - Loading states
  - Empty data (show "No data available" message)
  - API errors with user-friendly messages

---

# 2. DEPLOYMENT REQUIREMENTS

This Angular app **must work on GitHub Pages**:

### 2.1 Production Build
```bash
ng build --configuration production --output-path docs --base-href /amazing-frog/
```
*(Replace `/amazing-frog/` with your actual repository name)*

### 2.2 Routing Configuration
Use `HashLocationStrategy` because GitHub Pages cannot handle Angular routing without a server.

```typescript
// app.config.ts or app.module.ts
provideRouter(routes, withHashLocation())
```

### 2.3 GitHub Pages Setup
- Build output goes to `docs/` folder
- Create `docs/404.html` that redirects to `index.html`
- Enable GitHub Pages in repository settings ‚Üí Pages ‚Üí Source: `docs/` folder

---

# 3. TECHNOLOGY STACK

### Core Framework
- **Angular 18+** (standalone components preferred)
- **TypeScript 5+** with strict mode
- **Vite** (default Angular builder)
- **RxJS 7+** with reactive patterns

### UI Framework
- **Angular Material 18+**
  - Form controls (mat-select)
  - Cards (mat-card)
  - Progress indicators (mat-spinner, mat-progress-bar)
  - Grid layout (responsive)
  - Date range picker (mat-date-range-input) - optional for future enhancement

### Charts
- **ng2-charts** with **Chart.js 4+**
- Two responsive line charts with:
  - Proper time axis formatting
  - Tooltips showing date and value
  - Responsive design
  - Legend
  - Grid lines

### Code Quality Standards
- Strongly typed interfaces for all data
- Reactive patterns (no nested subscriptions)
- RxJS operators: `switchMap`, `tap`, `catchError`, `shareReplay`, `map`
- `async` pipe in templates (avoid manual subscriptions)
- Error handling service
- Loading state management

---

# 4. USGS OGC API INTEGRATION

**API Documentation:** https://api.waterdata.usgs.gov/ogcapi/v0/openapi#/

**Base URL:**
```
https://api.waterdata.usgs.gov/ogcapi/v0
```

All API responses follow GeoJSON format. The actual data is nested in `features[]` array.

---

## 4.1 Get States

**Endpoint:**
```
GET /collections/states/items?f=json&country_code=US&limit=10000
```

**Response Structure:**
```json
{
  "features": [
    {
      "properties": {
        "state_name": "Indiana",
        "state_fips_code": "18"
      }
    }
  ]
}
```

**Service Method:**
```typescript
getStates(): Observable<State[]> {
  return this.http.get<GeoJSONResponse>(`${baseUrl}/collections/states/items`, {
    params: { f: 'json', country_code: 'US', limit: '10000' }
  }).pipe(
    map(response => response.features.map(f => ({
      state_code: f.properties.state_fips_code,
      state_name: f.properties.state_name
    }))),
    shareReplay(1), // Cache states
    catchError(this.handleError)
  );
}
```

---

## 4.2 Get Counties

**Endpoint:**
```
GET /collections/counties/items?f=json&country_code=US&state_fips_code={stateCode}&limit=10000
```

**Response Structure:**
```json
{
  "features": [
    {
      "properties": {
        "county_name": "Montgomery County",
        "county_fips_code": "107",
        "state_fips_code": "18"
      }
    }
  ]
}
```

**Service Method:**
```typescript
getCounties(stateFipsCode: string): Observable<County[]>
```

---

## 4.3 Get Monitoring Locations

**Endpoint:**
```
GET /collections/monitoring-locations/items?f=json&country_code=US&state_fips_code={stateCode}&county_fips_code={countyCode}&site_type=Stream&limit=1000
```

**Response Structure:**
```json
{
  "features": [
    {
      "id": "USGS-03339500",
      "properties": {
        "monitoring_location_name": "SUGAR CREEK AT CRAWFORDSVILLE, IN",
        "monitoring_location_type": "Stream",
        "county_name": "Montgomery County"
      },
      "geometry": {
        "coordinates": [-86.874, 40.042]
      }
    }
  ]
}
```

**Service Method:**
```typescript
getMonitoringLocations(stateFipsCode: string, countyFipsCode: string): Observable<MonitoringLocation[]>
```

---

## 4.4 Get Time Series Data (Gage Height & Discharge)

**Endpoint Pattern:**
```
GET /collections/daily/items?monitoring_location_id=USGS-{id}&parameter_code={code}&statistic_id=00003&datetime={start}/{end}&limit=10000&f=json
```

**Parameters:**
- `monitoring_location_id`: e.g., `USGS-03339500`
- `parameter_code`: 
  - `00065` = Gage Height (ft)
  - `00060` = Streamflow (ft¬≥/s)
- `statistic_id`: `00003` = daily mean
- `datetime`: ISO date range, e.g., `2025-08-16/2025-11-16` (90 days)

**Response Structure:**
```json
{
  "numberReturned": 92,
  "features": [
    {
      "properties": {
        "time": "2025-11-02T00:00:00Z",
        "value": 7.02,
        "unit_of_measure": "ft"
      }
    }
  ]
}
```

**Service Methods:**
```typescript
getGageHeight(locationId: string, startDate: string, endDate: string): Observable<TimeSeriesData>

getStreamflow(locationId: string, startDate: string, endDate: string): Observable<TimeSeriesData>
```

**Date Calculation:**
```typescript
// Get last 90 days
const endDate = new Date();
const startDate = new Date();
startDate.setDate(endDate.getDate() - 90);

const dateRange = `${startDate.toISOString().split('T')[0]}/${endDate.toISOString().split('T')[0]}`;
```

---

# 5. DATA MODELS

Create strongly-typed interfaces:

```typescript
// GeoJSON wrapper
export interface GeoJSONResponse {
  features: GeoJSONFeature[];
  numberReturned?: number;
}

export interface GeoJSONFeature {
  id?: string;
  properties: any;
  geometry?: {
    coordinates: [number, number]; // [longitude, latitude]
  };
}

// Domain models
export interface State {
  state_code: string;
  state_name: string;
}

export interface County {
  county_code: string;
  county_name: string;
  state_code: string;
}

export interface MonitoringLocation {
  id: string;
  name: string;
  type: string;
  county_name: string;
  latitude: number;
  longitude: number;
}

export interface TimeSeriesPoint {
  time: string; // ISO 8601 date
  value: number;
}

export interface TimeSeriesData {
  locationId: string;
  parameterCode: string;
  parameterName: string;
  unit: string;
  points: TimeSeriesPoint[];
  hasData: boolean; // true if points.length > 0
}
```

---

# 6. APPLICATION STRUCTURE

Use Angular standalone components (modern approach):

```
src/
  app/
    app.component.ts
    app.config.ts
    app.routes.ts
    
    services/
      usgs-api.service.ts
      error-handler.service.ts
    
    models/
      api.models.ts
      domain.models.ts
    
    components/
      dashboard/
        dashboard.component.ts
        dashboard.component.html
        dashboard.component.scss
      
      site-card/
        site-card.component.ts
        site-card.component.html
        site-card.component.scss
      
      time-series-chart/
        time-series-chart.component.ts
        time-series-chart.component.html
        time-series-chart.component.scss
```

---

# 7. DASHBOARD COMPONENT REQUIREMENTS

## 7.1 Layout Structure

Use CSS Grid for responsive layout:

```
Desktop (>= 960px):
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                 ‚îÇ                       ‚îÇ
‚îÇ  Control Panel  ‚îÇ   Station Info Card   ‚îÇ
‚îÇ                 ‚îÇ                       ‚îÇ
‚îÇ  - State        ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  - County       ‚îÇ                       ‚îÇ
‚îÇ  - Location     ‚îÇ  Gage Height Chart    ‚îÇ
‚îÇ                 ‚îÇ                       ‚îÇ
‚îÇ                 ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                 ‚îÇ                       ‚îÇ
‚îÇ                 ‚îÇ  Streamflow Chart     ‚îÇ
‚îÇ                 ‚îÇ                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

Mobile (< 960px): Stack vertically
```

## 7.2 Control Panel Features

**State Dropdown:**
- Load states on component init
- Show loading spinner while fetching
- Sort alphabetically
- Auto-select first state (optional)

**County Dropdown:**
- Disabled until state selected
- Clear selection when state changes
- Show loading indicator

**Monitoring Location Dropdown:**
- Disabled until county selected
- Clear selection when county changes
- Display format: `{name} (ID: {id})`

**UX Requirements:**
- Show loading indicators for each dropdown
- Disable dependent dropdowns until parent is selected
- Clear child selections when parent changes
- Show error messages if API calls fail

## 7.3 Station Info Card

Display when monitoring location is selected:

- **Station Name**
- **USGS ID** (e.g., USGS-03339500)
- **Type** (e.g., Stream)
- **County**
- **Coordinates** (Latitude, Longitude)
- **Link to USGS site** (optional)

## 7.4 Charts

**Gage Height Chart (00065):**
- Title: "Daily Gage Height (Last 90 Days)"
- Y-axis: Height (ft)
- X-axis: Date
- Line color: Blue
- Show "No data available" if `numberReturned === 0`

**Streamflow Chart (00060):**
- Title: "Daily Streamflow (Last 90 Days)"
- Y-axis: Discharge (ft¬≥/s)
- X-axis: Date
- Line color: Green
- Show "No data available" if `numberReturned === 0`

**Chart Configuration:**
```typescript
{
  responsive: true,
  maintainAspectRatio: false,
  scales: {
    x: { 
      type: 'time',
      time: { unit: 'day' }
    },
    y: { 
      beginAtZero: false 
    }
  }
}
```

---

# 8. REACTIVE STATE MANAGEMENT

Use reactive patterns for cascading dropdowns:

```typescript
stateControl = new FormControl<string | null>(null);
countyControl = new FormControl<string | null>(null);
locationControl = new FormControl<string | null>(null);

// Reactive streams
states$ = this.usgsService.getStates();

counties$ = this.stateControl.valueChanges.pipe(
  filter(state => !!state),
  tap(() => this.countyControl.reset()),
  switchMap(state => this.usgsService.getCounties(state!)),
  shareReplay(1)
);

locations$ = this.countyControl.valueChanges.pipe(
  filter(county => !!county),
  tap(() => this.locationControl.reset()),
  switchMap(county => {
    const state = this.stateControl.value!;
    return this.usgsService.getMonitoringLocations(state, county!);
  }),
  shareReplay(1)
);

// Chart data
gageHeightData$ = this.locationControl.valueChanges.pipe(
  filter(loc => !!loc),
  switchMap(loc => this.loadGageHeight(loc!))
);

streamflowData$ = this.locationControl.valueChanges.pipe(
  filter(loc => !!loc),
  switchMap(loc => this.loadStreamflow(loc!))
);
```

---

# 9. ERROR HANDLING

Create a dedicated error handler service:

```typescript
@Injectable({ providedIn: 'root' })
export class ErrorHandlerService {
  handleError(error: HttpErrorResponse): Observable<never> {
    let userMessage = 'An error occurred. Please try again.';
    
    if (error.status === 0) {
      userMessage = 'Network error. Please check your connection.';
    } else if (error.status >= 500) {
      userMessage = 'Server error. Please try again later.';
    } else if (error.status === 404) {
      userMessage = 'Data not found.';
    }
    
    // Show snackbar or notification
    console.error('API Error:', error);
    return throwError(() => new Error(userMessage));
  }
}
```

---

# 10. STYLING REQUIREMENTS

## 10.1 Material Theme

Use a pre-built Angular Material theme or create custom:

```scss
@use '@angular/material' as mat;

$primary: mat.define-palette(mat.$indigo-palette);
$accent: mat.define-palette(mat.$pink-palette);

$theme: mat.define-light-theme((
  color: (
    primary: $primary,
    accent: $accent,
  )
));

@include mat.all-component-themes($theme);
```

## 10.2 Responsive Design

```scss
.dashboard-grid {
  display: grid;
  grid-template-columns: 300px 1fr;
  gap: 16px;
  padding: 16px;
  
  @media (max-width: 960px) {
    grid-template-columns: 1fr;
  }
}

.chart-container {
  height: 400px;
  position: relative;
}
```

---

# 11. ACCESSIBILITY

- Use semantic HTML
- Include ARIA labels for form controls
- Ensure keyboard navigation works
- Provide alt text for charts (via aria-label)
- Maintain color contrast ratios (WCAG AA)

---

# 12. TESTING REQUIREMENTS

## 12.1 Unit Tests
- Service methods (mock HTTP responses)
- Component logic
- Reactive stream transformations

## 12.2 E2E Tests (Optional)
- Complete user flow: State ‚Üí County ‚Üí Location ‚Üí Charts

---

# 13. DELIVERABLES

Your generated code must include:

1. **Complete Angular standalone application**
2. **All TypeScript files** with full implementations
3. **HTML templates** with proper structure
4. **SCSS styles** with responsive design
5. **README.md** with:
   - Setup instructions
   - Build commands
   - Deployment steps
6. **package.json** with all dependencies
7. **GitHub Actions workflow** for automated deployment (optional)

---

# 14. DEPLOYMENT CHECKLIST

- [ ] Build with production configuration
- [ ] Set correct `--base-href`
- [ ] Output to `docs/` folder
- [ ] Create `404.html` redirect
- [ ] Use HashLocationStrategy
- [ ] Test locally: `npx http-server docs`
- [ ] Push to GitHub
- [ ] Enable GitHub Pages
- [ ] Verify deployment

---

# 15. FUTURE ENHANCEMENTS (Optional)

- Date range picker for custom time periods
- Export data to CSV
- Compare multiple stations
- Real-time data updates
- Mobile app with Capacitor
- Dark mode toggle
- Favorite stations (localStorage)

---

**END OF SPECIFICATION**

# Amazing-Frog Water Station Dashboard

A modern Angular 20 application for visualizing USGS water monitoring station data, featuring real-time streamflow and gage height charts.

üåê **Live Demo:** [www.puddledude.com](https://www.puddledude.com)

## Features

- üìä Interactive time series charts for streamflow and gage height data
- üó∫Ô∏è Cascading location selection (State ‚Üí County ‚Üí Monitoring Location)
- üîÑ Real-time data from USGS Water Data Services API
- üì± Responsive design for desktop and mobile
- üé® Material Design UI with Angular Material

## Technology Stack

- **Angular 20.3** - Modern standalone components
- **TypeScript 5.9** - Type-safe development
- **RxJS 7.8** - Reactive data streams
- **Chart.js 4.4** - Interactive time series visualizations
- **Angular Material** - UI components and theming

## Development

### Prerequisites

- Node.js 18+ and npm
- Angular CLI 20.3+

### Setup

```bash
# Install dependencies
npm install

# Add Angular Material (if not already added)
ng add @angular/material

# Start development server
npm start
```

Navigate to `http://localhost:4200/`

### Build

```bash
# Development build
npm run build

# Production build for GitHub Pages
npm run build:github
```

## Deployment to GitHub Pages with Custom Domain

### 1. Build for Production

```bash
npm run build:github
```

This creates the `docs/` folder with your built application.

### 2. Configure Custom Domain

The `public/CNAME` file contains your custom domain:
```
www.puddledude.com
```

This file is automatically copied to `docs/CNAME` during the build.

### 3. Push to GitHub

```bash
git add .
git commit -m "Deploy to GitHub Pages"
git push origin main
```

### 4. Enable GitHub Pages

1. Go to your repository settings on GitHub
2. Navigate to **Pages** section
3. Under **Source**, select:
   - Branch: `main`
   - Folder: `/docs`
4. Click **Save**

### 5. Configure DNS at Namecheap

1. Log in to your Namecheap account
2. Go to **Domain List** ‚Üí Select `puddledude.com`
3. Click **Manage** ‚Üí **Advanced DNS**
4. Add these records:

| Type  | Host | Value                    | TTL       |
|-------|------|--------------------------|-----------|
| CNAME | www  | YOUR-USERNAME.github.io  | Automatic |
| A     | @    | 185.199.108.153          | Automatic |
| A     | @    | 185.199.109.153          | Automatic |
| A     | @    | 185.199.110.153          | Automatic |
| A     | @    | 185.199.111.153          | Automatic |

Replace `YOUR-USERNAME` with your actual GitHub username.

### 6. Verify Custom Domain in GitHub

1. Back in GitHub repository settings ‚Üí **Pages**
2. Under **Custom domain**, enter: `www.puddledude.com`
3. Click **Save**
4. Wait for DNS check to complete (may take a few minutes)
5. Enable **Enforce HTTPS** once DNS is verified

### 7. Wait for DNS Propagation

DNS changes can take 5-48 hours to propagate globally. You can check status at:
- https://www.whatsmydns.net/

## Project Structure

```
src/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard/         # Main dashboard component
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ chart/             # Reusable chart component
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ site-card/         # Station info card
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ usgs-api.service.ts      # USGS API integration
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ error-handler.service.ts # Centralized error handling
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api.models.ts            # API response types
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ domain.models.ts         # Domain models
‚îÇ   ‚îú‚îÄ‚îÄ app.ts                 # Root component
‚îÇ   ‚îú‚îÄ‚îÄ app.config.ts          # App configuration
‚îÇ   ‚îî‚îÄ‚îÄ app.routes.ts          # Routing
‚îú‚îÄ‚îÄ index.html
‚îú‚îÄ‚îÄ main.ts
‚îî‚îÄ‚îÄ styles.scss
```

## API Documentation

This application uses the [USGS Water Data Services API](https://api.waterdata.usgs.gov/ogcapi/v0/openapi):

- **States**: Lists all US states
- **Counties**: Lists counties within a state
- **Monitoring Locations**: Stream monitoring stations
- **Time Series Data**: Daily mean values for:
  - Streamflow (parameter code 00060)
  - Gage Height (parameter code 00065)

## Browser Support

- Chrome (latest)
- Firefox (latest)
- Safari (latest)
- Edge (latest)

## License

MIT

## Contributing

Pull requests are welcome! Please ensure:
1. Code follows Angular style guide
2. All tests pass
3. New features include tests
4. Commit messages are descriptive

## Troubleshooting

### Custom Domain Not Working

1. Verify DNS records at Namecheap are correct
2. Check DNS propagation: https://www.whatsmydns.net/
3. Ensure CNAME file exists in `docs/` folder
4. Verify GitHub Pages settings show custom domain

### Charts Not Rendering

1. Check browser console for errors
2. Verify Chart.js and chartjs-adapter-date-fns are installed
3. Ensure monitoring location has data for the selected time period

### API Errors

1. Check network tab for failed requests
2. Verify USGS API is accessible: https://api.waterdata.usgs.gov/ogcapi/v0
3. Check if monitoring location has data available

## Contact

For questions or support, please open an issue on GitHub.
````

### [.nojekyll](file:///c%3A/Users/dgrummon/git/amazing-frog/docs/.nojekyll)

```
```
```
```

This empty file tells GitHub Pages not to process files through Jekyll, which is important for Angular apps.

### Deployment Checklist

After making these changes, follow these steps:

**1. Build the application:**
```bash
npm run build:github
```

**2. Verify the build:**
- Check that docs folder exists
- Check that `docs/CNAME` contains `www.puddledude.com`
- Check that .nojekyll exists

**3. Commit and push to GitHub:**
```bash
git add .
git commit -m "Configure for GitHub Pages with custom domain"
git push origin main
```

**4. Configure GitHub Pages:**
- Go to repository Settings ‚Üí Pages
- Source: `main` branch, docs folder
- Custom domain: `www.puddledude.com`
- Enable "Enforce HTTPS" (after DNS verification)

**5. Configure Namecheap DNS:**
- Add CNAME record: `www` ‚Üí `your-github-username.github.io`
- Add A records for apex domain (185.199.108-111.153)

**6. Wait for DNS propagation:**
- Can take 5-48 hours
- Check status: https://www.whatsmydns.net/

**Key Changes Made:**

1. ‚úÖ Changed `--base-href` from `/amazing-frog/` to `/` (root domain)
2. ‚úÖ Created `public/CNAME` file with `www.puddledude.com`
3. ‚úÖ Updated .gitignore to include docs folder
4. ‚úÖ Added `.nojekyll` file to docs
5. ‚úÖ Updated README with complete deployment instructions
6. ‚úÖ Simplified build command for custom domain

Your app will be accessible at:
- ‚úÖ `https://www.puddledude.com`
- ‚úÖ `https://your-username.github.io/amazing-frog/` (fallback)

Made changes.

Similar code found with 3 license types

Dan-grummon: Is this ready now to push to the github repository to deploy as a github page?

GitHub Copilot: Almost ready! You need to make a few final changes before deploying:

### 1. Remove Debug Logging (Production Cleanup)

### [dashboard.component.ts](file:///c%3A/Users/dgrummon/git/amazing-frog/src/app/components/dashboard/dashboard.component.ts)

```typescript
// ...existing code...

    private setupStreams() {
        // ...existing code...

        // Date range for last 90 days
        const getDateRange = () => {
            const today = new Date();
            const endDate = new Date(today);
            const startDate = new Date(today);
            startDate.setDate(today.getDate() - 90);

            const start = startDate.toISOString().split('T')[0];
            const end = endDate.toISOString().split('T')[0];

            return { start, end };
        };

        // Gage height data stream
        this.gageHeightData$ = this.locationControl.valueChanges.pipe(
            switchMap((loc): Observable<TimeSeriesData | null> => {
                if (!loc) {
                    this.chartsLoading.set(false);
                    return of(null);
                }

                const { start, end } = getDateRange();
                this.chartsLoading.set(true);

                return this.usgsService.getGageHeight(loc, start, end).pipe(
                    tap(() => this.chartsLoading.set(false)),
                    catchError(() => {
                        this.chartsLoading.set(false);
                        return of(null);
                    })
                );
            }),
            shareReplay({ bufferSize: 1, refCount: false })
        );

        // Streamflow data stream
        this.streamflowData$ = this.locationControl.valueChanges.pipe(
            switchMap((loc): Observable<TimeSeriesData | null> => {
                if (!loc) return of(null);

                const { start, end } = getDateRange();

                return this.usgsService.getStreamflow(loc, start, end).pipe(
                    catchError(() => of(null))
                );
            }),
            shareReplay({ bufferSize: 1, refCount: false })
        );
    }
}
```

### 2. Remove Debug Console Logs from Service

### [usgs-api.service.ts](file:///c%3A/Users/dgrummon/git/amazing-frog/src/app/services/usgs-api.service.ts)

```typescript
// ...existing code...

    getMonitoringLocations(stateFipsCode: string, countyFipsCode: string): Observable<MonitoringLocation[]> {
        return this.http.get<GeoJSONResponse>(`${this.baseUrl}/collections/monitoring-locations/items`, {
            params: {
                f: 'json',
                country_code: 'US',
                state_code: stateFipsCode,
                county_code: countyFipsCode,
                agency_code: 'USGS',
                site_type: 'Stream',
                limit: '1000'
            }
        }).pipe(
            map(response => response.features.map(f => ({
                id: f.id || '',
                name: f.properties.monitoring_location_name,
                type: f.properties.site_type || f.properties.monitoring_location_type || 'Stream',
                county_name: f.properties.county_name,
                latitude: f.geometry?.coordinates[1] || 0,
                longitude: f.geometry?.coordinates[0] || 0
            }))),
            catchError(this.errorHandler.handleError.bind(this.errorHandler))
        );
    }

    // ...existing code...

    private getTimeSeries(
        locationId: string,
        parameterCode: string,
        startDate: string,
        endDate: string,
        parameterName: string,
        unit: string
    ): Observable<TimeSeriesData> {
        const datetime = `${startDate}/${endDate}`;

        return this.http.get<GeoJSONResponse>(`${this.baseUrl}/collections/daily/items`, {
            params: {
                monitoring_location_id: locationId,
                parameter_code: parameterCode,
                statistic_id: '00003',
                datetime: datetime,
                limit: '10000',
                f: 'json'
            }
        }).pipe(
            map(response => {
                const points = response.features
                    .map(f => ({
                        time: f.properties.time,
                        value: f.properties.value
                    }))
                    .sort((a, b) => new Date(a.time).getTime() - new Date(b.time).getTime());

                return {
                    locationId,
                    parameterCode,
                    parameterName,
                    unit,
                    points,
                    hasData: (response.numberReturned || 0) > 0 && points.length > 0
                };
            }),
            catchError(this.errorHandler.handleError.bind(this.errorHandler))
        );
    }
}
```

### 3. Create .nojekyll File

Create an empty `.nojekyll` file in the public folder (it will be copied to docs during build):

```bash
# In Git Bash or terminal:
touch public/.nojekyll
```

Or manually create an empty file at `c:\Users\dgrummon\git\amazing-frog\public\.nojekyll`

### 4. Verify/Create CNAME File

Ensure this file exists at `c:\Users\dgrummon\git\amazing-frog\public\CNAME` with content:

```
www.puddledude.com
```

---

## Now You're Ready! Deployment Steps:

### Step 1: Build for Production
```bash
npm run build:github
```

### Step 2: Verify Build Output
Check that these files exist in docs folder:
- `docs/index.html`
- `docs/CNAME` (containing `www.puddledude.com`)
- .nojekyll
- `docs/browser/` (with compiled JS/CSS)

### Step 3: Commit and Push
```bash
git add .
git commit -m "Deploy Angular app to GitHub Pages with custom domain"
git push origin main
```

### Step 4: Configure GitHub Pages
1. Go to your repository on GitHub
2. Settings ‚Üí Pages
3. Source: **main** branch, **/docs** folder
4. Custom domain: `www.puddledude.com`
5. Click **Save**
6. Wait for DNS check (green checkmark)
7. Enable **Enforce HTTPS**

### Step 5: Configure Namecheap DNS
Add these DNS records at Namecheap:

| Type  | Host | Value                          | TTL       |
|-------|------|--------------------------------|-----------|
| CNAME | www  | YOUR-USERNAME.github.io        | Automatic |
| A     | @    | 185.199.108.153                | Automatic |
| A     | @    | 185.199.109.153                | Automatic |
| A     | @    | 185.199.110.153                | Automatic |
| A     | @    | 185.199.111.153                | Automatic |

Replace `YOUR-USERNAME` with your GitHub username.

### Step 6: Wait for DNS Propagation
DNS changes can take 5-48 hours. Check status:
- https://www.whatsmydns.net/#CNAME/www.puddledude.com

---

## Quick Checklist Before Push:

- ‚úÖ `npm run build:github` completes successfully
- ‚úÖ docs folder exists with all files
- ‚úÖ `docs/CNAME` contains `www.puddledude.com`
- ‚úÖ .nojekyll exists (empty file)
- ‚úÖ All console.log statements removed from production code
- ‚úÖ .gitignore does NOT exclude docs folder

**You're ready to deploy!** üöÄ

Made changes.

Dan-grummon: there is a syntax error on line 73. The catch error section needs additional closing parentheses and curly braces. Please fix but be careful to not delete anything below line 75.

GitHub Copilot: ### [usgs-api.service.ts](file:///c%3A/Users/dgrummon/git/amazing-frog/src/app/services/usgs-api.service.ts)

```typescript
// ...existing code...

    getMonitoringLocations(stateFipsCode: string, countyFipsCode: string): Observable<MonitoringLocation[]> {
        return this.http.get<GeoJSONResponse>(`${this.baseUrl}/collections/monitoring-locations/items`, {
            params: {
                f: 'json',
                country_code: 'US',
                state_code: stateFipsCode,
                county_code: countyFipsCode,
                agency_code: 'USGS',
                site_type: 'Stream',
                limit: '1000'
            }
        }).pipe(
            map(response => response.features.map(f => ({
                id: f.id || '',
                name: f.properties.monitoring_location_name,
                type: f.properties.site_type || f.properties.monitoring_location_type || 'Stream',
                county_name: f.properties.county_name,
                latitude: f.geometry?.coordinates[1] || 0,
                longitude: f.geometry?.coordinates[0] || 0
            }))),
            catchError(this.errorHandler.handleError.bind(this.errorHandler))
        );
    }

    getGageHeight(locationId: string, startDate: string, endDate: string): Observable<TimeSeriesData> {
        return this.getTimeSeries(locationId, '00065', startDate, endDate, 'Gage Height', 'ft');
    }

// ...existing code...
```

The fix adds the missing closing parentheses after the inner `map` function and properly closes the `pipe()` method before the `catchError` operator.

Made changes.

Dan-grummon: It didnt work right. getGageHeight and getTimeSeries and getStreamflow and the catchError are all maked for delete.

GitHub Copilot: ### [usgs-api.service.ts](file:///c%3A/Users/dgrummon/git/amazing-frog/src/app/services/usgs-api.service.ts)

```typescript
// ...existing code...

    getMonitoringLocations(stateFipsCode: string, countyFipsCode: string): Observable<MonitoringLocation[]> {
        return this.http.get<GeoJSONResponse>(`${this.baseUrl}/collections/monitoring-locations/items`, {
            params: {
                f: 'json',
                country_code: 'US',
                state_code: stateFipsCode,
                county_code: countyFipsCode,
                agency_code: 'USGS',
                site_type: 'Stream',
                limit: '1000'
            }
        }).pipe(
            map(response => response.features.map(f => ({
                id: f.id || '',
                name: f.properties.monitoring_location_name,
                type: f.properties.site_type || f.properties.monitoring_location_type || 'Stream',
                county_name: f.properties.county_name,
                latitude: f.geometry?.coordinates[1] || 0,
                longitude: f.geometry?.coordinates[0] || 0
            }))),
            catchError(this.errorHandler.handleError.bind(this.errorHandler))
        );
    }

    getGageHeight(locationId: string, startDate: string, endDate: string): Observable<TimeSeriesData> {
        return this.getTimeSeries(locationId, '00065', startDate, endDate, 'Gage Height', 'ft');
    }

    getStreamflow(locationId: string, startDate: string, endDate: string): Observable<TimeSeriesData> {
        return this.getTimeSeries(locationId, '00060', startDate, endDate, 'Streamflow', 'ft¬≥/s');
    }

    private getTimeSeries(
        locationId: string,
        parameterCode: string,
        startDate: string,
        endDate: string,
        parameterName: string,
        unit: string
    ): Observable<TimeSeriesData> {
        const datetime = `${startDate}/${endDate}`;

        return this.http.get<GeoJSONResponse>(`${this.baseUrl}/collections/daily/items`, {
            params: {
                monitoring_location_id: locationId,
                parameter_code: parameterCode,
                statistic_id: '00003',
                datetime: datetime,
                limit: '10000',
                f: 'json'
            }
        }).pipe(
            map(response => {
                const points = response.features
                    .map(f => ({
                        time: f.properties.time,
                        value: f.properties.value
                    }))
                    .sort((a, b) => new Date(a.time).getTime() - new Date(b.time).getTime());

                return {
                    locationId,
                    parameterCode,
                    parameterName,
                    unit,
                    points,
                    hasData: (response.numberReturned || 0) > 0 && points.length > 0
                };
            }),
            catchError(this.errorHandler.handleError.bind(this.errorHandler))
        );
    }
}
```

I've properly closed the `getMonitoringLocations` method and kept all the other methods (`getGageHeight`, `getStreamflow`, `getTimeSeries`) intact. The issue was the missing closing parentheses and catchError placement in the `getMonitoringLocations` method.

Made changes.

Dan-grummon: For this section, there seems to be an extra USGS- prepended to the site id.

SUGAR CREEK AT CRAWFORDSVILLE, IN
USGS-USGS-03339500
Type:
Stream
County:
Montgomery County
Coordinates:
40.0503, -86.9073
View on USGS Website ‚Üí

GitHub Copilot: The issue is in the `site-card.component.html` template - it's displaying the full `location.id` which already contains `USGS-`, so when the template adds `USGS-` prefix again, it becomes `USGS-USGS-03339500`.

### [site-card.component.html](file:///c%3A/Users/dgrummon/git/amazing-frog/src/app/components/site-card/site-card.component.html)

```html
<mat-card class="site-info-card">
    <mat-card-header>
        <mat-card-title>{{ location.name }}</mat-card-title>
        <mat-card-subtitle>{{ location.id }}</mat-card-subtitle>
    </mat-card-header>
    <mat-card-content>
        <div class="info-grid">
            <div class="info-item">
                <strong>Type:</strong>
                <span>{{ location.type }}</span>
            </div>
            <div class="info-item">
                <strong>County:</strong>
                <span>{{ location.county_name }}</span>
            </div>
            <div class="info-item">
                <strong>Coordinates:</strong>
                <span>{{ location.latitude | number:'1.4-4' }}, {{ location.longitude | number:'1.4-4' }}</span>
            </div>
        </div>
    </mat-card-content>
    <mat-card-actions>
        <a mat-button color="primary" 
           [href]="'https://waterdata.usgs.gov/monitoring-location/' + location.id" 
           target="_blank">
            View on USGS Website ‚Üí
        </a>
    </mat-card-actions>
</mat-card>
```

**Key changes:**
1. Line 4: Changed from adding `USGS-` prefix to just displaying `{{ location.id }}` directly
2. Line 21: Changed from adding `USGS-` prefix to just using `location.id` directly in the URL

Since `location.id` already contains the full ID with `USGS-` prefix (e.g., `USGS-03339500`), we don't need to add it again.

Made changes.

Dan-grummon: what are the essential files needed from this code to copy to another freshly built angular application so that it will work? 

GitHub Copilot: To copy this working application to a fresh Angular project, you need these **essential files**:

## Core Application Files

### 1. Configuration Files (Root)
- angular.json - Build configuration with GitHub Pages settings
- package.json - All dependencies (Angular Material, Chart.js, etc.)
- tsconfig.json - TypeScript configuration

### 2. Source Files (src)
- index.html - App entry point
- main.ts - Bootstrap file
- styles.scss - Global styles with Material theme

### 3. App Core (app)
- app.ts - Root component
- app.html - Root template
- app.scss - Root styles
- app.config.ts - **CRITICAL** - Has HashLocationStrategy for GitHub Pages
- app.routes.ts - Routing configuration

### 4. Models (models)
- api.models.ts - GeoJSON interfaces
- domain.models.ts - Domain interfaces (State, County, etc.)

### 5. Services (services)
- usgs-api.service.ts - **CRITICAL** - All API calls with fixes
- error-handler.service.ts - Error handling

### 6. Components (components)

**Dashboard:**
- dashboard.component.ts - **CRITICAL** - Reactive streams with eager subscriptions
- dashboard.component.html
- dashboard.component.scss

**Chart:**
- chart.component.ts - **CRITICAL** - Chart.js integration
- chart.component.html
- chart.component.scss

**Site Card:**
- site-card.component.ts
- site-card.component.html
- site-card.component.scss

### 7. Public Assets (public)
- `public/CNAME` - Custom domain configuration
- `public/.nojekyll` - GitHub Pages configuration

---

## Copy Process

### Step 1: Create Fresh Angular App
```bash
ng new my-app --routing --style=scss
cd my-app
```

### Step 2: Install Dependencies
```bash
npm install @angular/material @angular/cdk chart.js chartjs-adapter-date-fns date-fns
```

### Step 3: Copy Files in This Order

1. **Replace root config files:**
   - Copy angular.json (replace entire file)
   - Copy package.json (replace entire file)
   - Copy tsconfig.json (replace entire file)

2. **Replace src/ files:**
   - Copy index.html
   - Copy main.ts
   - Copy styles.scss

3. **Replace app core:**
   - Copy all files from app (app.ts, app.html, app.scss, app.config.ts, app.routes.ts)

4. **Copy folders:**
   - Copy entire models folder
   - Copy entire services folder
   - Copy entire components folder

5. **Copy public assets:**
   - Copy `public/CNAME`
   - Copy `public/.nojekyll`

### Step 4: Install Dependencies
```bash
npm install
```

### Step 5: Test
```bash
npm start
```

### Step 6: Build for GitHub Pages
```bash
npm run build:github
```

---

## Minimum File List (22 files)

```
angular.json
package.json
tsconfig.json
src/index.html
src/main.ts
src/styles.scss
src/app/app.ts
src/app/app.html
src/app/app.scss
src/app/app.config.ts
src/app/app.routes.ts
src/app/models/api.models.ts
src/app/models/domain.models.ts
src/app/services/usgs-api.service.ts
src/app/services/error-handler.service.ts
src/app/components/dashboard/dashboard.component.ts
src/app/components/dashboard/dashboard.component.html
src/app/components/dashboard/dashboard.component.scss
src/app/components/chart/chart.component.ts
src/app/components/chart/chart.component.html
src/app/components/chart/chart.component.scss
src/app/components/site-card/site-card.component.ts
src/app/components/site-card/site-card.component.html
src/app/components/site-card/site-card.component.scss
public/CNAME
public/.nojekyll
```

---

## Critical Files (Cannot Skip)

These **7 files** contain the bug fixes and are absolutely essential:

1. **`app.config.ts`** - HashLocationStrategy for GitHub Pages
2. **`usgs-api.service.ts`** - Sorted data + agency_code filter
3. **`dashboard.component.ts`** - Eager subscriptions with refCount: false
4. **`chart.component.ts`** - Chart.js configuration
5. **package.json** - Correct dependencies
6. **angular.json** - Build configuration
7. **`public/CNAME`** - Custom domain

Without these, you'll encounter the bugs we fixed! üêõ‚Üí‚úÖ

Dan-grummon: please create a new md file with what is described here

GitHub Copilot: ### [DEPLOYMENT-GUIDE.md](file:///c%3A/Users/dgrummon/git/amazing-frog/DEPLOYMENT-GUIDE.md)

```markdown
# Deployment Guide for Amazing-Frog Water Station Dashboard

This guide explains how to deploy the Angular application to GitHub Pages with a custom domain (www.puddledude.com).

---

## Prerequisites

- Git installed and configured
- GitHub repository created
- Node.js and npm installed
- Namecheap account with domain purchased

---

## Step 1: Prepare the Application

### 1.1 Install Dependencies

```bash
npm install
```

### 1.2 Create Required Files

Ensure these files exist in the public folder:

**File: `public/CNAME`**
```
www.puddledude.com
```

**File: `public/.nojekyll`** (empty file)
```
(no content - just create an empty file)
```

---

## Step 2: Build for Production

### 2.1 Run Production Build

```bash
npm run build:github
```

This command:
- Builds the app with production optimizations
- Outputs to docs folder
- Sets base href to `/` for root domain
- Copies `CNAME` and `.nojekyll` to docs

### 2.2 Verify Build Output

Check that these files exist:

```
docs/
‚îú‚îÄ‚îÄ browser/
‚îÇ   ‚îú‚îÄ‚îÄ index.html
‚îÇ   ‚îú‚îÄ‚îÄ main-[hash].js
‚îÇ   ‚îú‚îÄ‚îÄ polyfills-[hash].js
‚îÇ   ‚îî‚îÄ‚îÄ styles-[hash].css
‚îú‚îÄ‚îÄ CNAME (contains: www.puddledude.com)
‚îî‚îÄ‚îÄ .nojekyll (empty file)
```

---

## Step 3: Push to GitHub

### 3.1 Initial Commit (First Time Only)

```bash
git add .
git commit -m "Initial commit: Angular water station dashboard"
git branch -M main
git remote add origin https://github.com/YOUR-USERNAME/amazing-frog.git
git push -u origin main
```

### 3.2 Subsequent Deployments

```bash
git add .
git commit -m "Deploy updated application"
git push origin main
```

---

## Step 4: Configure GitHub Pages

1. Go to your repository on GitHub
2. Click **Settings** (top right)
3. Click **Pages** in the left sidebar
4. Under **Source**:
   - Branch: `main`
   - Folder: docs
5. Click **Save**
6. Under **Custom domain**:
   - Enter: `www.puddledude.com`
   - Click **Save**
7. Wait for DNS check to complete (green checkmark)
8. Enable **Enforce HTTPS** (checkbox appears after DNS verification)

**Note:** DNS check may take 5-48 hours depending on DNS propagation.

---

## Step 5: Configure DNS at Namecheap

### 5.1 Log in to Namecheap

1. Go to https://www.namecheap.com
2. Log in to your account
3. Go to **Domain List**
4. Click **Manage** next to `puddledude.com`

### 5.2 Configure DNS Records

1. Click **Advanced DNS** tab
2. Delete any existing A or CNAME records for `@` and `www`
3. Add the following records:

| Type  | Host | Value                          | TTL       |
|-------|------|--------------------------------|-----------|
| CNAME | www  | YOUR-USERNAME.github.io        | Automatic |
| A     | @    | 185.199.108.153                | Automatic |
| A     | @    | 185.199.109.153                | Automatic |
| A     | @    | 185.199.110.153                | Automatic |
| A     | @    | 185.199.111.153                | Automatic |

**Replace `YOUR-USERNAME` with your actual GitHub username.**

**Example:** If your GitHub username is `johndoe`, the CNAME value would be:
```
johndoe.github.io
```

### 5.3 Save Changes

Click **Save All Changes** at the bottom of the page.

---

## Step 6: Wait for DNS Propagation

DNS changes can take **5-48 hours** to propagate globally.

### Check DNS Propagation Status

Use these tools to check if DNS has propagated:

- https://www.whatsmydns.net/#CNAME/www.puddledude.com
- https://dnschecker.org/

Look for:
- CNAME record: `www.puddledude.com` ‚Üí `YOUR-USERNAME.github.io`
- A records: `puddledude.com` ‚Üí `185.199.108.153` (and other IPs)

---

## Step 7: Verify Deployment

### 7.1 Local Testing (Before DNS Propagates)

Test the GitHub Pages URL:

```
https://YOUR-USERNAME.github.io/amazing-frog/
```

### 7.2 Custom Domain Testing (After DNS Propagates)

Once DNS has propagated, visit:

```
https://www.puddledude.com
```

**Expected behavior:**
- HTTPS is enforced (redirects from HTTP to HTTPS)
- Application loads and functions correctly
- Hash routing works (URLs look like `#/`)

---

## Troubleshooting

### Issue: 404 Error on GitHub Pages

**Solution:**
1. Check that docs folder exists in your repository
2. Verify GitHub Pages settings point to `main` branch and docs folder
3. Ensure `.nojekyll` file exists in docs folder

### Issue: Custom Domain Not Working

**Solution:**
1. Verify `CNAME` file exists in docs folder with correct content
2. Check DNS records at Namecheap match Step 5.2
3. Wait longer for DNS propagation (can take 48 hours)
4. Use https://www.whatsmydns.net/ to check propagation status

### Issue: HTTPS Not Working

**Solution:**
1. Wait for DNS to fully propagate
2. In GitHub Pages settings, try:
   - Uncheck "Enforce HTTPS"
   - Wait 5 minutes
   - Re-check "Enforce HTTPS"

### Issue: Charts Not Rendering

**Solution:**
1. Open browser console (F12)
2. Check for errors
3. Verify Chart.js and chartjs-adapter-date-fns are in package.json
4. Rebuild: `npm run build:github`

### Issue: Application Shows Wrong URLs

**Solution:**
1. Verify angular.json has `"baseHref": "/"` in production config
2. Verify `app.config.ts` uses `withHashLocation()`
3. Rebuild application

---

## Updating the Application

### Standard Update Process

1. Make code changes
2. Test locally: `npm start`
3. Build for production: `npm run build:github`
4. Commit changes: `git add . && git commit -m "Update description"`
5. Push to GitHub: `git push origin main`
6. Wait 2-5 minutes for GitHub Pages to rebuild
7. Verify changes at https://www.puddledude.com

### Quick Deploy Script (Optional)

Create `deploy.sh`:

```bash
#!/bin/bash
echo "Building for production..."
npm run build:github

echo "Committing changes..."
git add .
git commit -m "Deploy: $(date +'%Y-%m-%d %H:%M:%S')"

echo "Pushing to GitHub..."
git push origin main

echo "Deployment complete! Wait 2-5 minutes for GitHub Pages to update."
```

Make executable and run:
```bash
chmod +x deploy.sh
./deploy.sh
```

---

## Rollback Procedure

If deployment breaks the application:

```bash
# View commit history
git log --oneline

# Rollback to previous commit
git revert HEAD

# Or reset to specific commit
git reset --hard COMMIT_HASH

# Force push
git push origin main --force
```

---

## Monitoring and Maintenance

### Check Application Health

1. Visit https://www.puddledude.com
2. Test the complete user flow:
   - Select state
   - Select county
   - Select monitoring location
   - Verify charts render
3. Check browser console for errors

### Monthly Maintenance

- Update dependencies: `npm update`
- Check for Angular updates: `ng update`
- Test thoroughly after updates
- Rebuild and redeploy

---

## Security Notes

- Never commit sensitive data (API keys, passwords)
- Keep dependencies updated
- Enable "Enforce HTTPS" in GitHub Pages
- Review GitHub security alerts regularly

---

## Support and Resources

- **GitHub Pages Documentation:** https://docs.github.com/en/pages
- **Namecheap DNS Guide:** https://www.namecheap.com/support/knowledgebase/article.aspx/319/2237/how-can-i-set-up-an-a-address-record-for-my-domain/
- **Angular CLI Documentation:** https://angular.dev/cli
- **USGS API Documentation:** https://api.waterdata.usgs.gov/ogcapi/v0/openapi

---

## Contact

For issues or questions, open an issue on GitHub:
https://github.com/YOUR-USERNAME/amazing-frog/issues
```

This deployment guide provides complete step-by-step instructions for deploying your Angular application to GitHub Pages with a custom Namecheap domain. It includes troubleshooting, maintenance procedures, and all necessary configuration details.
This deployment guide provides complete step-by-step instructions for deploying your Angular application to GitHub Pages with a custom Namecheap domain. It includes troubleshooting, maintenance procedures, and all necessary configuration details.

Made changes.

Dan-grummon: deployment guide only has 28 lines and did not capture what was output to this chat

GitHub Copilot: ### [DEPLOYMENT-GUIDE.md](file:///c%3A/Users/dgrummon/git/amazing-frog/DEPLOYMENT-GUIDE.md)

```markdown
# Deployment Guide for Amazing-Frog Water Station Dashboard

This guide explains how to deploy the Angular application to GitHub Pages with a custom domain (www.puddledude.com).

---

## Prerequisites

- Git installed and configured
- GitHub repository created
- Node.js and npm installed
- Namecheap account with domain purchased

---

## Step 1: Prepare the Application

### 1.1 Install Dependencies

```bash
npm install
```

### 1.2 Create Required Files

Ensure these files exist in the public folder:

**File: `public/CNAME`**
```
www.puddledude.com
```

**File: `public/.nojekyll`** (empty file)
```
(no content - just create an empty file)
```

---

## Step 2: Build for Production

### 2.1 Run Production Build

```bash
npm run build:github
```

This command:
- Builds the app with production optimizations
- Outputs to docs folder
- Sets base href to `/` for root domain
- Copies `CNAME` and `.nojekyll` to docs

### 2.2 Verify Build Output

Check that these files exist:

```
docs/
‚îú‚îÄ‚îÄ browser/
‚îÇ   ‚îú‚îÄ‚îÄ index.html
‚îÇ   ‚îú‚îÄ‚îÄ main-[hash].js
‚îÇ   ‚îú‚îÄ‚îÄ polyfills-[hash].js
‚îÇ   ‚îî‚îÄ‚îÄ styles-[hash].css
‚îú‚îÄ‚îÄ CNAME (contains: www.puddledude.com)
‚îî‚îÄ‚îÄ .nojekyll (empty file)
```

---

## Step 3: Push to GitHub

### 3.1 Initial Commit (First Time Only)

```bash
git add .
git commit -m "Initial commit: Angular water station dashboard"
git branch -M main
git remote add origin https://github.com/YOUR-USERNAME/amazing-frog.git
git push -u origin main
```

### 3.2 Subsequent Deployments

```bash
git add .
git commit -m "Deploy updated application"
git push origin main
```

---

## Step 4: Configure GitHub Pages

1. Go to your repository on GitHub
2. Click **Settings** (top right)
3. Click **Pages** in the left sidebar
4. Under **Source**:
   - Branch: `main`
   - Folder: docs
5. Click **Save**
6. Under **Custom domain**:
   - Enter: `www.puddledude.com`
   - Click **Save**
7. Wait for DNS check to complete (green checkmark)
8. Enable **Enforce HTTPS** (checkbox appears after DNS verification)

**Note:** DNS check may take 5-48 hours depending on DNS propagation.

---

## Step 5: Configure DNS at Namecheap

### 5.1 Log in to Namecheap

1. Go to https://www.namecheap.com
2. Log in to your account
3. Go to **Domain List**
4. Click **Manage** next to `puddledude.com`

### 5.2 Configure DNS Records

1. Click **Advanced DNS** tab
2. Delete any existing A or CNAME records for `@` and `www`
3. Add the following records:

| Type  | Host | Value                          | TTL       |
|-------|------|--------------------------------|-----------|
| CNAME | www  | YOUR-USERNAME.github.io        | Automatic |
| A     | @    | 185.199.108.153                | Automatic |
| A     | @    | 185.199.109.153                | Automatic |
| A     | @    | 185.199.110.153                | Automatic |
| A     | @    | 185.199.111.153                | Automatic |

**Replace `YOUR-USERNAME` with your actual GitHub username.**

**Example:** If your GitHub username is `johndoe`, the CNAME value would be:
```
johndoe.github.io
```

### 5.3 Save Changes

Click **Save All Changes** at the bottom of the page.

---

## Step 6: Wait for DNS Propagation

DNS changes can take **5-48 hours** to propagate globally.

### Check DNS Propagation Status

Use these tools to check if DNS has propagated:

- https://www.whatsmydns.net/#CNAME/www.puddledude.com
- https://dnschecker.org/

Look for:
- CNAME record: `www.puddledude.com` ‚Üí `YOUR-USERNAME.github.io`
- A records: `puddledude.com` ‚Üí `185.199.108.153` (and other IPs)

---

## Step 7: Verify Deployment

### 7.1 Local Testing (Before DNS Propagates)

Test the GitHub Pages URL:

```
https://YOUR-USERNAME.github.io/amazing-frog/
```

### 7.2 Custom Domain Testing (After DNS Propagates)

Once DNS has propagated, visit:

```
https://www.puddledude.com
```

**Expected behavior:**
- HTTPS is enforced (redirects from HTTP to HTTPS)
- Application loads and functions correctly
- Hash routing works (URLs look like `#/`)

---

## Troubleshooting

### Issue: 404 Error on GitHub Pages

**Solution:**
1. Check that docs folder exists in your repository
2. Verify GitHub Pages settings point to `main` branch and docs folder
3. Ensure `.nojekyll` file exists in docs folder

### Issue: Custom Domain Not Working

**Solution:**
1. Verify `CNAME` file exists in docs folder with correct content
2. Check DNS records at Namecheap match Step 5.2
3. Wait longer for DNS propagation (can take 48 hours)
4. Use https://www.whatsmydns.net/ to check propagation status

### Issue: HTTPS Not Working

**Solution:**
1. Wait for DNS to fully propagate
2. In GitHub Pages settings, try:
   - Uncheck "Enforce HTTPS"
   - Wait 5 minutes
   - Re-check "Enforce HTTPS"

### Issue: Charts Not Rendering

**Solution:**
1. Open browser console (F12)
2. Check for errors
3. Verify Chart.js and chartjs-adapter-date-fns are in package.json
4. Rebuild: `npm run build:github`

### Issue: Application Shows Wrong URLs

**Solution:**
1. Verify angular.json has `"baseHref": "/"` in production config
2. Verify `app.config.ts` uses `withHashLocation()`
3. Rebuild application

---

## Updating the Application

### Standard Update Process

1. Make code changes
2. Test locally: `npm start`
3. Build for production: `npm run build:github`
4. Commit changes: `git add . && git commit -m "Update description"`
5. Push to GitHub: `git push origin main`
6. Wait 2-5 minutes for GitHub Pages to rebuild
7. Verify changes at https://www.puddledude.com

### Quick Deploy Script (Optional)

Create `deploy.sh`:

```bash
#!/bin/bash
echo "Building for production..."
npm run build:github

echo "Committing changes..."
git add .
git commit -m "Deploy: $(date +'%Y-%m-%d %H:%M:%S')"

echo "Pushing to GitHub..."
git push origin main

echo "Deployment complete! Wait 2-5 minutes for GitHub Pages to update."
```

Make executable and run:
```bash
chmod +x deploy.sh
./deploy.sh
```

---

## Rollback Procedure

If deployment breaks the application:

```bash
# View commit history
git log --oneline

# Rollback to previous commit
git revert HEAD

# Or reset to specific commit
git reset --hard COMMIT_HASH

# Force push
git push origin main --force
```

---

## Monitoring and Maintenance

### Check Application Health

1. Visit https://www.puddledude.com
2. Test the complete user flow:
   - Select state
   - Select county
   - Select monitoring location
   - Verify charts render
3. Check browser console for errors

### Monthly Maintenance

- Update dependencies: `npm update`
- Check for Angular updates: `ng update`
- Test thoroughly after updates
- Rebuild and redeploy

---

## Security Notes

- Never commit sensitive data (API keys, passwords)
- Keep dependencies updated
- Enable "Enforce HTTPS" in GitHub Pages
- Review GitHub security alerts regularly

---

## Support and Resources

- **GitHub Pages Documentation:** https://docs.github.com/en/pages
- **Namecheap DNS Guide:** https://www.namecheap.com/support/knowledgebase/article.aspx/319/2237/how-can-i-set-up-an-a-address-record-for-my-domain/
- **Angular CLI Documentation:** https://angular.dev/cli
- **USGS API Documentation:** https://api.waterdata.usgs.gov/ogcapi/v0/openapi

---

## Contact

For issues or questions, open an issue on GitHub:
https://github.com/YOUR-USERNAME/amazing-frog/issues
```

This is the complete deployment guide with all sections included.
This is the complete deployment guide with all sections included.

Made changes.

Dan-grummon: also include a section on essential files needed to be copied over into a new, freshly built, angular version 20 application.

GitHub Copilot: ### [DEPLOYMENT-GUIDE.md](file:///c%3A/Users/dgrummon/git/amazing-frog/DEPLOYMENT-GUIDE.md)

```markdown
# Deployment Guide for Amazing-Frog Water Station Dashboard

This guide explains how to deploy the Angular application to GitHub Pages with a custom domain (www.puddledude.com).

---

## Prerequisites

- Git installed and configured
- GitHub repository created
- Node.js and npm installed
- Namecheap account with domain purchased

---

## Part A: Copying to a Fresh Angular 20 Application

If you want to recreate this application in a fresh Angular 20 project, follow these steps.

### A.1 Create Fresh Angular App

```bash
ng new my-water-dashboard --routing --style=scss
cd my-water-dashboard
```

### A.2 Install Dependencies

```bash
npm install @angular/material @angular/cdk chart.js chartjs-adapter-date-fns date-fns
```

### A.3 Add Angular Material

```bash
ng add @angular/material
```

When prompted:
- Choose a theme: **Indigo/Pink** (or any prebuilt theme)
- Set up typography: **Yes**
- Include animations: **Yes**

### A.4 Essential Files to Copy

Copy these files from the working application to your fresh project:

#### Configuration Files (Root Level)
```
angular.json          # Build configuration with GitHub Pages settings
package.json          # All dependencies
tsconfig.json         # TypeScript configuration
```

#### Source Files (src/)
```
src/index.html        # App entry point
src/main.ts           # Bootstrap file
src/styles.scss       # Global styles with Material theme
```

#### App Core (src/app/)
```
src/app/app.ts        # Root component
src/app/app.html      # Root template
src/app/app.scss      # Root styles
src/app/app.config.ts # CRITICAL: Has HashLocationStrategy for GitHub Pages
src/app/app.routes.ts # Routing configuration
```

#### Models (src/app/models/)
```
src/app/models/api.models.ts     # GeoJSON interfaces
src/app/models/domain.models.ts  # Domain models (State, County, etc.)
```

#### Services (src/app/services/)
```
src/app/services/usgs-api.service.ts      # CRITICAL: All API calls with fixes
src/app/services/error-handler.service.ts # Error handling
```

#### Components (src/app/components/)

**Dashboard Component:**
```
src/app/components/dashboard/dashboard.component.ts    # CRITICAL: Reactive streams
src/app/components/dashboard/dashboard.component.html  # Template
src/app/components/dashboard/dashboard.component.scss  # Styles
```

**Chart Component:**
```
src/app/components/chart/chart.component.ts    # CRITICAL: Chart.js integration
src/app/components/chart/chart.component.html  # Template
src/app/components/chart/chart.component.scss  # Styles
```

**Site Card Component:**
```
src/app/components/site-card/site-card.component.ts
src/app/components/site-card/site-card.component.html
src/app/components/site-card/site-card.component.scss
```

#### Public Assets (public/)
```
public/CNAME       # Custom domain configuration
public/.nojekyll   # GitHub Pages configuration (empty file)
```

### A.5 Critical Files (Cannot Skip)

These **7 files** contain the bug fixes and are absolutely essential:

1. **`app.config.ts`** - HashLocationStrategy for GitHub Pages
2. **`usgs-api.service.ts`** - Sorted data + agency_code filter + correct ID handling
3. **`dashboard.component.ts`** - Eager subscriptions with refCount: false
4. **`chart.component.ts`** - Chart.js configuration with proper sizing
5. **package.json** - Correct dependencies (Chart.js, Material, etc.)
6. **angular.json** - Build configuration for GitHub Pages
7. **`public/CNAME`** - Custom domain

### A.6 File Copy Checklist

```
‚úÖ angular.json
‚úÖ package.json
‚úÖ tsconfig.json
‚úÖ src/index.html
‚úÖ src/main.ts
‚úÖ src/styles.scss
‚úÖ src/app/app.ts
‚úÖ src/app/app.html
‚úÖ src/app/app.scss
‚úÖ src/app/app.config.ts
‚úÖ src/app/app.routes.ts
‚úÖ src/app/models/api.models.ts
‚úÖ src/app/models/domain.models.ts
‚úÖ src/app/services/usgs-api.service.ts
‚úÖ src/app/services/error-handler.service.ts
‚úÖ src/app/components/dashboard/dashboard.component.ts
‚úÖ src/app/components/dashboard/dashboard.component.html
‚úÖ src/app/components/dashboard/dashboard.component.scss
‚úÖ src/app/components/chart/chart.component.ts
‚úÖ src/app/components/chart/chart.component.html
‚úÖ src/app/components/chart/chart.component.scss
‚úÖ src/app/components/site-card/site-card.component.ts
‚úÖ src/app/components/site-card/site-card.component.html
‚úÖ src/app/components/site-card/site-card.component.scss
‚úÖ public/CNAME
‚úÖ public/.nojekyll
```

### A.7 After Copying Files

```bash
# Install all dependencies
npm install

# Test locally
npm start

# Build for GitHub Pages
npm run build:github
```

---

## Part B: Deployment Steps

### Step 1: Prepare the Application

#### 1.1 Install Dependencies

```bash
npm install
```

#### 1.2 Create Required Files

Ensure these files exist in the public folder:

**File: `public/CNAME`**
```
www.puddledude.com
```

**File: `public/.nojekyll`** (empty file)
```
(no content - just create an empty file)
```

---

### Step 2: Build for Production

#### 2.1 Run Production Build

```bash
npm run build:github
```

This command:
- Builds the app with production optimizations
- Outputs to docs folder
- Sets base href to `/` for root domain
- Copies `CNAME` and `.nojekyll` to docs

#### 2.2 Verify Build Output

Check that these files exist:

```
docs/
‚îú‚îÄ‚îÄ browser/
‚îÇ   ‚îú‚îÄ‚îÄ index.html
‚îÇ   ‚îú‚îÄ‚îÄ main-[hash].js
‚îÇ   ‚îú‚îÄ‚îÄ polyfills-[hash].js
‚îÇ   ‚îî‚îÄ‚îÄ styles-[hash].css
‚îú‚îÄ‚îÄ CNAME (contains: www.puddledude.com)
‚îî‚îÄ‚îÄ .nojekyll (empty file)
```

---

### Step 3: Push to GitHub

#### 3.1 Initial Commit (First Time Only)

```bash
git add .
git commit -m "Initial commit: Angular water station dashboard"
git branch -M main
git remote add origin https://github.com/YOUR-USERNAME/amazing-frog.git
git push -u origin main
```

#### 3.2 Subsequent Deployments

```bash
git add .
git commit -m "Deploy updated application"
git push origin main
```

---

### Step 4: Configure GitHub Pages

1. Go to your repository on GitHub
2. Click **Settings** (top right)
3. Click **Pages** in the left sidebar
4. Under **Source**:
   - Branch: `main`
   - Folder: docs
5. Click **Save**
6. Under **Custom domain**:
   - Enter: `www.puddledude.com`
   - Click **Save**
7. Wait for DNS check to complete (green checkmark)
8. Enable **Enforce HTTPS** (checkbox appears after DNS verification)

**Note:** DNS check may take 5-48 hours depending on DNS propagation.

---

### Step 5: Configure DNS at Namecheap

#### 5.1 Log in to Namecheap

1. Go to https://www.namecheap.com
2. Log in to your account
3. Go to **Domain List**
4. Click **Manage** next to `puddledude.com`

#### 5.2 Configure DNS Records

1. Click **Advanced DNS** tab
2. Delete any existing A or CNAME records for `@` and `www`
3. Add the following records:

| Type  | Host | Value                          | TTL       |
|-------|------|--------------------------------|-----------|
| CNAME | www  | YOUR-USERNAME.github.io        | Automatic |
| A     | @    | 185.199.108.153                | Automatic |
| A     | @    | 185.199.109.153                | Automatic |
| A     | @    | 185.199.110.153                | Automatic |
| A     | @    | 185.199.111.153                | Automatic |

**Replace `YOUR-USERNAME` with your actual GitHub username.**

**Example:** If your GitHub username is `johndoe`, the CNAME value would be:
```
johndoe.github.io
```

#### 5.3 Save Changes

Click **Save All Changes** at the bottom of the page.

---

### Step 6: Wait for DNS Propagation

DNS changes can take **5-48 hours** to propagate globally.

#### Check DNS Propagation Status

Use these tools to check if DNS has propagated:

- https://www.whatsmydns.net/#CNAME/www.puddledude.com
- https://dnschecker.org/

Look for:
- CNAME record: `www.puddledude.com` ‚Üí `YOUR-USERNAME.github.io`
- A records: `puddledude.com` ‚Üí `185.199.108.153` (and other IPs)

---

### Step 7: Verify Deployment

#### 7.1 Local Testing (Before DNS Propagates)

Test the GitHub Pages URL:

```
https://YOUR-USERNAME.github.io/amazing-frog/
```

#### 7.2 Custom Domain Testing (After DNS Propagates)

Once DNS has propagated, visit:

```
https://www.puddledude.com
```

**Expected behavior:**
- HTTPS is enforced (redirects from HTTP to HTTPS)
- Application loads and functions correctly
- Hash routing works (URLs look like `#/`)

---

## Part C: Troubleshooting

### Issue: 404 Error on GitHub Pages

**Solution:**
1. Check that docs folder exists in your repository
2. Verify GitHub Pages settings point to `main` branch and docs folder
3. Ensure `.nojekyll` file exists in docs folder

### Issue: Custom Domain Not Working

**Solution:**
1. Verify `CNAME` file exists in docs folder with correct content
2. Check DNS records at Namecheap match Step 5.2
3. Wait longer for DNS propagation (can take 48 hours)
4. Use https://www.whatsmydns.net/ to check propagation status

### Issue: HTTPS Not Working

**Solution:**
1. Wait for DNS to fully propagate
2. In GitHub Pages settings, try:
   - Uncheck "Enforce HTTPS"
   - Wait 5 minutes
   - Re-check "Enforce HTTPS"

### Issue: Charts Not Rendering

**Solution:**
1. Open browser console (F12)
2. Check for errors
3. Verify Chart.js and chartjs-adapter-date-fns are in package.json
4. Rebuild: `npm run build:github`

### Issue: Application Shows Wrong URLs

**Solution:**
1. Verify angular.json has `"baseHref": "/"` in production config
2. Verify `app.config.ts` uses `withHashLocation()`
3. Rebuild application

### Issue: Infinite Loading Spinner on First Location Selection

**Solution:**
This was a critical bug that's been fixed. Ensure you copied:
- `dashboard.component.ts` with eager subscriptions in `ngOnInit()`
- `shareReplay({ bufferSize: 1, refCount: false })` on chart observables

### Issue: Chart Shows Random Scribbled Lines

**Solution:**
This was a critical bug. Ensure `usgs-api.service.ts` sorts time series data:
```typescript
.sort((a, b) => new Date(a.time).getTime() - new Date(b.time).getTime())
```

---

## Part D: Updating the Application

### Standard Update Process

1. Make code changes
2. Test locally: `npm start`
3. Build for production: `npm run build:github`
4. Commit changes: `git add . && git commit -m "Update description"`
5. Push to GitHub: `git push origin main`
6. Wait 2-5 minutes for GitHub Pages to rebuild
7. Verify changes at https://www.puddledude.com

### Quick Deploy Script (Optional)

Create `deploy.sh`:

```bash
#!/bin/bash
echo "Building for production..."
npm run build:github

echo "Committing changes..."
git add .
git commit -m "Deploy: $(date +'%Y-%m-%d %H:%M:%S')"

echo "Pushing to GitHub..."
git push origin main

echo "Deployment complete! Wait 2-5 minutes for GitHub Pages to update."
```

Make executable and run:
```bash
chmod +x deploy.sh
./deploy.sh
```

---

## Part E: Rollback Procedure

If deployment breaks the application:

```bash
# View commit history
git log --oneline

# Rollback to previous commit
git revert HEAD

# Or reset to specific commit
git reset --hard COMMIT_HASH

# Force push
git push origin main --force
```

---

## Part F: Monitoring and Maintenance

### Check Application Health

1. Visit https://www.puddledude.com
2. Test the complete user flow:
   - Select state
   - Select county
   - Select monitoring location
   - Verify charts render correctly
3. Check browser console for errors

### Monthly Maintenance

- Update dependencies: `npm update`
- Check for Angular updates: `ng update`
- Test thoroughly after updates
- Rebuild and redeploy

---

## Part G: Security Notes

- Never commit sensitive data (API keys, passwords)
- Keep dependencies updated
- Enable "Enforce HTTPS" in GitHub Pages
- Review GitHub security alerts regularly

---

## Part H: Support and Resources

- **GitHub Pages Documentation:** https://docs.github.com/en/pages
- **Namecheap DNS Guide:** https://www.namecheap.com/support/knowledgebase/article.aspx/319/2237/how-can-i-set-up-an-a-address-record-for-my-domain/
- **Angular CLI Documentation:** https://angular.dev/cli
- **USGS API Documentation:** https://api.waterdata.usgs.gov/ogcapi/v0/openapi
- **Chart.js Documentation:** https://www.chartjs.org/docs/latest/

---

## Contact

For issues or questions, open an issue on GitHub:
https://github.com/YOUR-USERNAME/amazing-frog/issues
```

I've added **Part A: Copying to a Fresh Angular 20 Application** at the beginning of the deployment guide. This section includes:

1. Steps to create a fresh Angular 20 app
2. Installing dependencies
3. Complete list of essential files to copy (26 files total)
4. Explanation of which 7 files are absolutely critical
5. A checklist for tracking copied files
6. Post-copy verification steps

The guide now covers both scenarios:
- **Part A**: Starting from scratch with a fresh Angular 20 app
- **Parts B-H**: Deploying the existing application to GitHub Pages with custom domain
I've added **Part A: Copying to a Fresh Angular 20 Application** at the beginning of the deployment guide. This section includes:

1. Steps to create a fresh Angular 20 app
2. Installing dependencies
3. Complete list of essential files to copy (26 files total)
4. Explanation of which 7 files are absolutely critical
5. A checklist for tracking copied files
6. Post-copy verification steps

The guide now covers both scenarios:
- **Part A**: Starting from scratch with a fresh Angular 20 app
- **Parts B-H**: Deploying the existing application to GitHub Pages with custom domain

Made changes.

Dan-grummon: This is good information but it did not get added to the deployment guide. I see 

GitHub Copilot: You're right! The DEPLOYMENT-GUIDE.md file didn't get fully updated. Let me create the complete version with all sections:

### [DEPLOYMENT-GUIDE.md](file:///c%3A/Users/dgrummon/git/amazing-frog/DEPLOYMENT-GUIDE.md)

```markdown
# Deployment Guide for Amazing-Frog Water Station Dashboard

This guide explains how to deploy the Angular application to GitHub Pages with a custom domain (www.puddledude.com).

---

## Prerequisites

- Git installed and configured
- GitHub repository created
- Node.js and npm installed
- Namecheap account with domain purchased

---

## Part A: Copying to a Fresh Angular 20 Application

If you want to recreate this application in a fresh Angular 20 project, follow these steps.

### A.1 Create Fresh Angular App

```bash
ng new my-water-dashboard --routing --style=scss
cd my-water-dashboard
```

### A.2 Install Dependencies

```bash
npm install @angular/material @angular/cdk chart.js chartjs-adapter-date-fns date-fns
```

### A.3 Add Angular Material

```bash
ng add @angular/material
```

When prompted:
- Choose a theme: **Indigo/Pink** (or any prebuilt theme)
- Set up typography: **Yes**
- Include animations: **Yes**

### A.4 Essential Files to Copy

Copy these files from the working application to your fresh project:

#### Configuration Files (Root Level)
```
angular.json          # Build configuration with GitHub Pages settings
package.json          # All dependencies
tsconfig.json         # TypeScript configuration
```

#### Source Files (src/)
```
src/index.html        # App entry point
src/main.ts           # Bootstrap file
src/styles.scss       # Global styles with Material theme
```

#### App Core (src/app/)
```
src/app/app.ts        # Root component
src/app/app.html      # Root template
src/app/app.scss      # Root styles
src/app/app.config.ts # CRITICAL: Has HashLocationStrategy for GitHub Pages
src/app/app.routes.ts # Routing configuration
```

#### Models (src/app/models/)
```
src/app/models/api.models.ts     # GeoJSON interfaces
src/app/models/domain.models.ts  # Domain models (State, County, etc.)
```

#### Services (src/app/services/)
```
src/app/services/usgs-api.service.ts      # CRITICAL: All API calls with fixes
src/app/services/error-handler.service.ts # Error handling
```

#### Components (src/app/components/)

**Dashboard Component:**
```
src/app/components/dashboard/dashboard.component.ts    # CRITICAL: Reactive streams
src/app/components/dashboard/dashboard.component.html  # Template
src/app/components/dashboard/dashboard.component.scss  # Styles
```

**Chart Component:**
```
src/app/components/chart/chart.component.ts    # CRITICAL: Chart.js integration
src/app/components/chart/chart.component.html  # Template
src/app/components/chart/chart.component.scss  # Styles
```

**Site Card Component:**
```
src/app/components/site-card/site-card.component.ts
src/app/components/site-card/site-card.component.html
src/app/components/site-card/site-card.component.scss
```

#### Public Assets (public/)
```
public/CNAME       # Custom domain configuration
public/.nojekyll   # GitHub Pages configuration (empty file)
```

### A.5 Critical Files (Cannot Skip)

These **7 files** contain the bug fixes and are absolutely essential:

1. **`app.config.ts`** - HashLocationStrategy for GitHub Pages
2. **`usgs-api.service.ts`** - Sorted data + agency_code filter + correct ID handling
3. **`dashboard.component.ts`** - Eager subscriptions with refCount: false
4. **`chart.component.ts`** - Chart.js configuration with proper sizing
5. **package.json** - Correct dependencies (Chart.js, Material, etc.)
6. **angular.json** - Build configuration for GitHub Pages
7. **`public/CNAME`** - Custom domain

### A.6 File Copy Checklist

```
‚úÖ angular.json
‚úÖ package.json
‚úÖ tsconfig.json
‚úÖ src/index.html
‚úÖ src/main.ts
‚úÖ src/styles.scss
‚úÖ src/app/app.ts
‚úÖ src/app/app.html
‚úÖ src/app/app.scss
‚úÖ src/app/app.config.ts
‚úÖ src/app/app.routes.ts
‚úÖ src/app/models/api.models.ts
‚úÖ src/app/models/domain.models.ts
‚úÖ src/app/services/usgs-api.service.ts
‚úÖ src/app/services/error-handler.service.ts
‚úÖ src/app/components/dashboard/dashboard.component.ts
‚úÖ src/app/components/dashboard/dashboard.component.html
‚úÖ src/app/components/dashboard/dashboard.component.scss
‚úÖ src/app/components/chart/chart.component.ts
‚úÖ src/app/components/chart/chart.component.html
‚úÖ src/app/components/chart/chart.component.scss
‚úÖ src/app/components/site-card/site-card.component.ts
‚úÖ src/app/components/site-card/site-card.component.html
‚úÖ src/app/components/site-card/site-card.component.scss
‚úÖ public/CNAME
‚úÖ public/.nojekyll
```

### A.7 After Copying Files

```bash
# Install all dependencies
npm install

# Test locally
npm start

# Build for GitHub Pages
npm run build:github
```

---

## Part B: Deployment Steps

### Step 1: Prepare the Application

#### 1.1 Install Dependencies

```bash
npm install
```

#### 1.2 Create Required Files

Ensure these files exist in the public folder:

**File: `public/CNAME`**
```
www.puddledude.com
```

**File: `public/.nojekyll`** (empty file)
```
(no content - just create an empty file)
```

---

### Step 2: Build for Production

#### 2.1 Run Production Build

```bash
npm run build:github
```

This command:
- Builds the app with production optimizations
- Outputs to docs folder
- Sets base href to `/` for root domain
- Copies `CNAME` and `.nojekyll` to docs

#### 2.2 Verify Build Output

Check that these files exist:

```
docs/
‚îú‚îÄ‚îÄ browser/
‚îÇ   ‚îú‚îÄ‚îÄ index.html
‚îÇ   ‚îú‚îÄ‚îÄ main-[hash].js
‚îÇ   ‚îú‚îÄ‚îÄ polyfills-[hash].js
‚îÇ   ‚îî‚îÄ‚îÄ styles-[hash].css
‚îú‚îÄ‚îÄ CNAME (contains: www.puddledude.com)
‚îî‚îÄ‚îÄ .nojekyll (empty file)
```

---

### Step 3: Push to GitHub

#### 3.1 Initial Commit (First Time Only)

```bash
git add .
git commit -m "Initial commit: Angular water station dashboard"
git branch -M main
git remote add origin https://github.com/YOUR-USERNAME/amazing-frog.git
git push -u origin main
```

#### 3.2 Subsequent Deployments

```bash
git add .
git commit -m "Deploy updated application"
git push origin main
```

---

### Step 4: Configure GitHub Pages

1. Go to your repository on GitHub
2. Click **Settings** (top right)
3. Click **Pages** in the left sidebar
4. Under **Source**:
   - Branch: `main`
   - Folder: docs
5. Click **Save**
6. Under **Custom domain**:
   - Enter: `www.puddledude.com`
   - Click **Save**
7. Wait for DNS check to complete (green checkmark)
8. Enable **Enforce HTTPS** (checkbox appears after DNS verification)

**Note:** DNS check may take 5-48 hours depending on DNS propagation.

---

### Step 5: Configure DNS at Namecheap

#### 5.1 Log in to Namecheap

1. Go to https://www.namecheap.com
2. Log in to your account
3. Go to **Domain List**
4. Click **Manage** next to `puddledude.com`

#### 5.2 Configure DNS Records

1. Click **Advanced DNS** tab
2. Delete any existing A or CNAME records for `@` and `www`
3. Add the following records:

| Type  | Host | Value                          | TTL       |
|-------|------|--------------------------------|-----------|
| CNAME | www  | YOUR-USERNAME.github.io        | Automatic |
| A     | @    | 185.199.108.153                | Automatic |
| A     | @    | 185.199.109.153                | Automatic |
| A     | @    | 185.199.110.153                | Automatic |
| A     | @    | 185.199.111.153                | Automatic |

**Replace `YOUR-USERNAME` with your actual GitHub username.**

**Example:** If your GitHub username is `johndoe`, the CNAME value would be:
```
johndoe.github.io
```

#### 5.3 Save Changes

Click **Save All Changes** at the bottom of the page.

---

### Step 6: Wait for DNS Propagation

DNS changes can take **5-48 hours** to propagate globally.

#### Check DNS Propagation Status

Use these tools to check if DNS has propagated:

- https://www.whatsmydns.net/#CNAME/www.puddledude.com
- https://dnschecker.org/

Look for:
- CNAME record: `www.puddledude.com` ‚Üí `YOUR-USERNAME.github.io`
- A records: `puddledude.com` ‚Üí `185.199.108.153` (and other IPs)

---

### Step 7: Verify Deployment

#### 7.1 Local Testing (Before DNS Propagates)

Test the GitHub Pages URL:

```
https://YOUR-USERNAME.github.io/amazing-frog/
```

#### 7.2 Custom Domain Testing (After DNS Propagates)

Once DNS has propagated, visit:

```
https://www.puddledude.com
```

**Expected behavior:**
- HTTPS is enforced (redirects from HTTP to HTTPS)
- Application loads and functions correctly
- Hash routing works (URLs look like `#/`)

---

## Part C: Troubleshooting

### Issue: 404 Error on GitHub Pages

**Solution:**
1. Check that docs folder exists in your repository
2. Verify GitHub Pages settings point to `main` branch and docs folder
3. Ensure `.nojekyll` file exists in docs folder

### Issue: Custom Domain Not Working

**Solution:**
1. Verify `CNAME` file exists in docs folder with correct content
2. Check DNS records at Namecheap match Step 5.2
3. Wait longer for DNS propagation (can take 48 hours)
4. Use https://www.whatsmydns.net/ to check propagation status

### Issue: HTTPS Not Working

**Solution:**
1. Wait for DNS to fully propagate
2. In GitHub Pages settings, try:
   - Uncheck "Enforce HTTPS"
   - Wait 5 minutes
   - Re-check "Enforce HTTPS"

### Issue: Charts Not Rendering

**Solution:**
1. Open browser console (F12)
2. Check for errors
3. Verify Chart.js and chartjs-adapter-date-fns are in package.json
4. Rebuild: `npm run build:github`

### Issue: Application Shows Wrong URLs

**Solution:**
1. Verify angular.json has `"baseHref": "/"` in production config
2. Verify `app.config.ts` uses `withHashLocation()`
3. Rebuild application

### Issue: Infinite Loading Spinner on First Location Selection

**Solution:**
This was a critical bug that's been fixed. Ensure you copied:
- `dashboard.component.ts` with eager subscriptions in `ngOnInit()`
- `shareReplay({ bufferSize: 1, refCount: false })` on chart observables

### Issue: Chart Shows Random Scribbled Lines

**Solution:**
This was a critical bug. Ensure `usgs-api.service.ts` sorts time series data:
```typescript
.sort((a, b) => new Date(a.time).getTime() - new Date(b.time).getTime())
```

---

## Part D: Updating the Application

### Standard Update Process

1. Make code changes
2. Test locally: `npm start`
3. Build for production: `npm run build:github`
4. Commit changes: `git add . && git commit -m "Update description"`
5. Push to GitHub: `git push origin main`
6. Wait 2-5 minutes for GitHub Pages to rebuild
7. Verify changes at https://www.puddledude.com

### Quick Deploy Script (Optional)

Create `deploy.sh`:

```bash
#!/bin/bash
echo "Building for production..."
npm run build:github

echo "Committing changes..."
git add .
git commit -m "Deploy: $(date +'%Y-%m-%d %H:%M:%S')"

echo "Pushing to GitHub..."
git push origin main

echo "Deployment complete! Wait 2-5 minutes for GitHub Pages to update."
```

Make executable and run:
```bash
chmod +x deploy.sh
./deploy.sh
```

---

## Part E: Rollback Procedure

If deployment breaks the application:

```bash
# View commit history
git log --oneline

# Rollback to previous commit
git revert HEAD

# Or reset to specific commit
git reset --hard COMMIT_HASH

# Force push
git push origin main --force
```

---

## Part F: Monitoring and Maintenance

### Check Application Health

1. Visit https://www.puddledude.com
2. Test the complete user flow:
   - Select state
   - Select county
   - Select monitoring location
   - Verify charts render correctly
3. Check browser console for errors

### Monthly Maintenance

- Update dependencies: `npm update`
- Check for Angular updates: `ng update`
- Test thoroughly after updates
- Rebuild and redeploy

---

## Part G: Security Notes

- Never commit sensitive data (API keys, passwords)
- Keep dependencies updated
- Enable "Enforce HTTPS" in GitHub Pages
- Review GitHub security alerts regularly

---

## Part H: Support and Resources

- **GitHub Pages Documentation:** https://docs.github.com/en/pages
- **Namecheap DNS Guide:** https://www.namecheap.com/support/knowledgebase/article.aspx/319/2237/how-can-i-set-up-an-a-address-record-for-my-domain/
- **Angular CLI Documentation:** https://angular.dev/cli
- **USGS API Documentation:** https://api.waterdata.usgs.gov/ogcapi/v0/openapi
- **Chart.js Documentation:** https://www.chartjs.org/docs/latest/

---

## Contact

For issues or questions, open an issue on GitHub:
https://github.com/YOUR-USERNAME/amazing-frog/issues
```

Now the DEPLOYMENT-GUIDE.md file contains all 8 parts (A through H) with complete instructions for:
- Part A: Copying to a fresh Angular 20 app
- Part B: Deployment steps
- Part C: Troubleshooting
- Part D: Updating
- Part E: Rollback
- Part F: Monitoring
- Part G: Security
- Part H: Resources
Now the DEPLOYMENT-GUIDE.md file contains all 8 parts (A through H) with complete instructions for:
- Part A: Copying to a fresh Angular 20 app
- Part B: Deployment steps
- Part C: Troubleshooting
- Part D: Updating
- Part E: Rollback
- Part F: Monitoring
- Part G: Security
- Part H: Resources

Made changes.
